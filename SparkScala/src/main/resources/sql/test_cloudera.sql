#drop table if exists employee
#CREATE TABLE employee (empname string,city string,salary int) USING com.databricks.spark.csv OPTIONS (path "/Users/ashok.kumar/github/workspace/spark/input/join/emp_salary.csv")
#select city,sum(salary) from employee group by city order by city
#drop table if exists employee_pq
#CREATE TABLE employee_pq (empname string,city string,salary int) stored as parquet
#insert into table employee_pq select * from employee
#select * from employee_pq
#select * from employee
set hive.exec.dynamic.partition.mode=nonstrict
#set spark.sql.hive.convertMetastoreOrc=true
#set spark.sql.orc.enabled=true
#CREATE TABLE IF NOT EXISTS temp ( ITEMID BIGINT ,BUSINESSID SMALLINT ,SUBCATEGORYN INT ,ITEMNUMBER INT ,UNITSPERPACKAGE INT ,FLD01 BIGINT ,FLD02 BIGINT ,FLD03 BIGINT ,FLD04 BIGINT ,FLD05 BIGINT ,FLD06 BIGINT ,FLD07 BIGINT ,FLD08 BIGINT ,FLD09 BIGINT ,FLD10 BIGINT ,FLD11 BIGINT ,FLD12 BIGINT ,FLD13 BIGINT ,FLD14 BIGINT ,FLD15 BIGINT ,FLD16 BIGINT ,FLD17 BIGINT ,FLD18 BIGINT ,FLD19 BIGINT ,FLD20 BIGINT ,FLD21 BIGINT ,FLD22 BIGINT ,FLD23 BIGINT ,FLD24 BIGINT ,FLD25 BIGINT ,FLD26 BIGINT ,FLD27 BIGINT ,FLD28 BIGINT ,FLD29 BIGINT ,FLD30 BIGINT ,FLD31 BIGINT ,FLD32 BIGINT ,FLD33 BIGINT ,FLD34 BIGINT ,FLD35 BIGINT ,FLD36 BIGINT ,FLD37 BIGINT ,FLD38 BIGINT ,FLD39 BIGINT ,FLD40 BIGINT ,FLD41 BIGINT ,FLD42 BIGINT ,FLD43 BIGINT ,FLD44 BIGINT ,FLD45 BIGINT ,FLD46 BIGINT ,FLD47 BIGINT ,FLD48 BIGINT ,FLD49 BIGINT ,FLD50 BIGINT ,FLD51 BIGINT ,FLD52 BIGINT ,FLD53 BIGINT ,FLD54 BIGINT ,FLD55 BIGINT ,FLD56 BIGINT ,FLD57 BIGINT ,FLD58 BIGINT ,FLD59 BIGINT ,FLD60 BIGINT ,FLD61 BIGINT ,FLD62 BIGINT ,FLD63 BIGINT ,FLD64 BIGINT ,FLD65 BIGINT ,FLD66 BIGINT ,FLD67 BIGINT ,FLD68 BIGINT ,FLD69 BIGINT ,FLD70 BIGINT ,FLD71 BIGINT ,FLD72 BIGINT ,FLD73 BIGINT ,FLD74 BIGINT ,FLD75 BIGINT ,FLD76 BIGINT ,FLD77 BIGINT ,FLD78 BIGINT ,FLD79 BIGINT ,FLD80 BIGINT ,FLD81 BIGINT ,FLD82 BIGINT ,FLD83 BIGINT ,FLD84 BIGINT ,FLD85 BIGINT ,FLD86 BIGINT ,FLD87 BIGINT ,FLD88 BIGINT ,FLD89 BIGINT ,FLD90 BIGINT ,FLD91 BIGINT ,FLD92 BIGINT ,FLD93 BIGINT ,FLD94 BIGINT ,FLD95 BIGINT ,FLD96 BIGINT ,FLD97 BIGINT ,FLD98 BIGINT ,FLD99 BIGINT ,STATUS TINYINT ,ADDED TIMESTAMP ,UPDATED TIMESTAMP ,VFLD01 DOUBLE ,VFLD02 DOUBLE ,VFLD03 DOUBLE ,VFLD04 DOUBLE ,VFLD05 DOUBLE ,COUNTRY_CODE INT ,GROUPITEMID BIGINT ,PARENTITEMID BIGINT ,PARENTITEMID_STATUS TINYINT ,OUTLETITEM_MAP_CHANGE_DATE TIMESTAMP ,LOCKDOWN_STATUS TINYINT,pk_closeout_data_state string,pk_business_id smallint )ROW format delimited FIELDS terminated by ','
LOAD DATA LOCAL INPATH '/Users/ashok.kumar/github/workspace/spark/input/hive_in.csv' OVERWRITE INTO TABLE temp
#CREATE EXTERNAL TABLE IF NOT EXISTS ods_positems ( ITEMID BIGINT ,BUSINESSID SMALLINT ,SUBCATEGORYN INT ,ITEMNUMBER INT ,UNITSPERPACKAGE INT ,FLD01 BIGINT ,FLD02 BIGINT ,FLD03 BIGINT ,FLD04 BIGINT ,FLD05 BIGINT ,FLD06 BIGINT ,FLD07 BIGINT ,FLD08 BIGINT ,FLD09 BIGINT ,FLD10 BIGINT ,FLD11 BIGINT ,FLD12 BIGINT ,FLD13 BIGINT ,FLD14 BIGINT ,FLD15 BIGINT ,FLD16 BIGINT ,FLD17 BIGINT ,FLD18 BIGINT ,FLD19 BIGINT ,FLD20 BIGINT ,FLD21 BIGINT ,FLD22 BIGINT ,FLD23 BIGINT ,FLD24 BIGINT ,FLD25 BIGINT ,FLD26 BIGINT ,FLD27 BIGINT ,FLD28 BIGINT ,FLD29 BIGINT ,FLD30 BIGINT ,FLD31 BIGINT ,FLD32 BIGINT ,FLD33 BIGINT ,FLD34 BIGINT ,FLD35 BIGINT ,FLD36 BIGINT ,FLD37 BIGINT ,FLD38 BIGINT ,FLD39 BIGINT ,FLD40 BIGINT ,FLD41 BIGINT ,FLD42 BIGINT ,FLD43 BIGINT ,FLD44 BIGINT ,FLD45 BIGINT ,FLD46 BIGINT ,FLD47 BIGINT ,FLD48 BIGINT ,FLD49 BIGINT ,FLD50 BIGINT ,FLD51 BIGINT ,FLD52 BIGINT ,FLD53 BIGINT ,FLD54 BIGINT ,FLD55 BIGINT ,FLD56 BIGINT ,FLD57 BIGINT ,FLD58 BIGINT ,FLD59 BIGINT ,FLD60 BIGINT ,FLD61 BIGINT ,FLD62 BIGINT ,FLD63 BIGINT ,FLD64 BIGINT ,FLD65 BIGINT ,FLD66 BIGINT ,FLD67 BIGINT ,FLD68 BIGINT ,FLD69 BIGINT ,FLD70 BIGINT ,FLD71 BIGINT ,FLD72 BIGINT ,FLD73 BIGINT ,FLD74 BIGINT ,FLD75 BIGINT ,FLD76 BIGINT ,FLD77 BIGINT ,FLD78 BIGINT ,FLD79 BIGINT ,FLD80 BIGINT ,FLD81 BIGINT ,FLD82 BIGINT ,FLD83 BIGINT ,FLD84 BIGINT ,FLD85 BIGINT ,FLD86 BIGINT ,FLD87 BIGINT ,FLD88 BIGINT ,FLD89 BIGINT ,FLD90 BIGINT ,FLD91 BIGINT ,FLD92 BIGINT ,FLD93 BIGINT ,FLD94 BIGINT ,FLD95 BIGINT ,FLD96 BIGINT ,FLD97 BIGINT ,FLD98 BIGINT ,FLD99 BIGINT ,STATUS TINYINT ,ADDED TIMESTAMP ,UPDATED TIMESTAMP ,VFLD01 DOUBLE ,VFLD02 DOUBLE ,VFLD03 DOUBLE ,VFLD04 DOUBLE ,VFLD05 DOUBLE ,COUNTRY_CODE INT ,GROUPITEMID BIGINT ,PARENTITEMID BIGINT ,PARENTITEMID_STATUS TINYINT ,OUTLETITEM_MAP_CHANGE_DATE TIMESTAMP ,LOCKDOWN_STATUS TINYINT ) comment ' ods_positems for closeout ' partitioned by (pk_closeout_data_state string,pk_business_id smallint) STORED AS textfile LOCATION '/Users/ashok.kumar/github/workspace/spark/store/ext/ods_positems'
#insert overwrite table ods_positems select * from temp
#select * from temp
